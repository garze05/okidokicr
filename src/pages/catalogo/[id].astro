---
export const prerender = false;
import MainLayout from "@layouts/MainLayout.astro";
import ServiceDetail from "@components/landing/catalog/ServiceDetail.jsx";

// Get the service ID from URL params
const { id } = Astro.params;

// Get the initial image index from URL search params
const initialImageIndex = parseInt(Astro.url.searchParams.get("image") || "0");

// Basic service fetch for metadata (title for SEO)
const apiUrl = import.meta.env.PUBLIC_API_URL;
let pageTitle = "Servicio";
try {
  const res = await fetch(`${apiUrl}/services/${id}`);
  if (res.ok) {
    const service = await res.json();
    pageTitle = service.title;
  }
} catch (error) {
  console.error("Error fetching service for metadata:", error);
}
---

<MainLayout title={pageTitle}>
  <ServiceDetail
    serviceId={id}
    initialImageIndex={initialImageIndex}
    client:load
  />
</MainLayout>
